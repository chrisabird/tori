<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.99.1"><meta name=viewport content="width=device-width,initial-scale=1"><title>Sorting colors &#183; トリ</title><meta name=description content><link type=text/css rel=stylesheet href=https://chrisabird.github.io/tori/css/print.css media=print><link type=text/css rel=stylesheet href=https://chrisabird.github.io/tori/css/poole.css><link type=text/css rel=stylesheet href=https://chrisabird.github.io/tori/css/syntax.css><link type=text/css rel=stylesheet href=https://chrisabird.github.io/tori/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body class=theme-base-0b><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://chrisabird.github.io/tori/><h1>トリ</h1></a><p class=lead>Chris Bird</p></div><nav><ul class=sidebar-nav><li><a href=https://chrisabird.github.io/tori/>Home</a></li></ul></nav><p>&copy; 2022. All rights reserved.</p></div></aside><main class="content container"><div class=post><h1>Sorting colors</h1><time datetime=2013-10-06T00:00:00Z class=post-date>Sun, Oct 6, 2013</time><p>Previously i talked about <a href=/posts/finding-similar-colors>finding similar colors</a>, I&rsquo;d now like to move onto sorting.</p><h2 id=given-a-sparse-set-of-colors-how-do-i-arrange-them-in-an-aesthetically-pleasing-order>given a sparse set of colors how do i arrange them in an aesthetically pleasing order.</h2><p>There is an inherent problem with this statement through. I have two axis in which I can work on screen x and y, but color is three dimensional. So we have to work out a way to minimise one of those axis or combine two to achieve something close to a pleasant lay down.</p><p>So here is a jumble of colors from around the color red&mldr;</p><div style=margin-bottom:32px;overflow:auto><div style=float:left;width:40px;height:40px;background-color:#db9099>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f3d1c9>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#efd9d0>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f1e5dc>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#d79380>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#842328>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#b77774>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#aa3f55>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#d29a98>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#e2c3bf>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#eeded7>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#712a29>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f1a7a2>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#af5142>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#ac568e>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#e7d9e3>&nbsp;</div></div><div style=clear:left></div><h3 id=what-happens-if-we-order-by-rgb>What happens if we order by RGB</h3><p>Sorting the colors like this&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-clojure data-lang=clojure><span style=display:flex><span>	(<span style=color:#66d9ef>defn </span>sort-by-rgb [colors]
</span></span><span style=display:flex><span>	  (sort-by (<span style=color:#a6e22e>juxt</span> <span style=color:#e6db74>:rgbR</span> <span style=color:#e6db74>:rgbG</span> <span style=color:#e6db74>:rgbB</span>) colors))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	(<span style=color:#a6e22e>fact</span> <span style=color:#e6db74>&#34;can sort colors by rgb&#34;</span>
</span></span><span style=display:flex><span>		(first (<span style=color:#a6e22e>sort-by-rgb</span> red-colors)) 
</span></span><span style=display:flex><span>		   =&gt; (<span style=color:#a6e22e>contains</span> {<span style=color:#e6db74>:rgbR</span> <span style=color:#ae81ff>113</span> <span style=color:#e6db74>:rgbG</span> <span style=color:#ae81ff>42</span> <span style=color:#e6db74>:rgbB</span> <span style=color:#ae81ff>41</span>})
</span></span><span style=display:flex><span>	  (last (<span style=color:#a6e22e>sort-by-rgb</span> red-colors)) 
</span></span><span style=display:flex><span>	     =&gt; (<span style=color:#a6e22e>contains</span> {<span style=color:#e6db74>:rgbR</span> <span style=color:#ae81ff>243</span> <span style=color:#e6db74>:rgbG</span> <span style=color:#ae81ff>209</span> <span style=color:#e6db74>:rgbB</span> <span style=color:#ae81ff>201</span>})) </span></span></code></pre></div><p>Which looks like this&mldr;</p><div style=margin-bottom:32px;overflow:auto><div style=float:left;width:40px;height:40px;background-color:#712a29>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#842328>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#aa3f55>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#ac568e;text-align:center>A</div><div style=float:left;width:40px;height:40px;background-color:#af5142>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#b77774>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#d29a98>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#d79380>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#db9099>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#e2c3bf>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#e7d9e3>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#eeded7>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#efd9d0>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f1a7a2;text-align:center>B</div><div style=float:left;width:40px;height:40px;background-color:#f1e5dc>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f3d1c9>&nbsp;</div></div><div style=clear:left></div><p>This doesn&rsquo;t look right&mldr;</p><ol><li>Color (A) is appearing in the middle of the reds, as we&rsquo;re not taking into account the other colors that are being mixed in (aka the hue).</li><li>Color (B) is appearing in the middle of lighter/less-intense colors. Because with RGB we&rsquo;re only sorting by how much of each color is present not how bright the overall color is.</li></ol><p>There are a few possible ways to make this look better&mldr;</p><h3 id=ordering-by-hue-luminosity-and-chroma>Ordering by Hue, Luminosity and Chroma.</h3><p>This method works well if you have a large set of colors or if you have a set of colors that span a large portion of the color spectrum.</p><p>For this we&rsquo;re going to have to switch color models again. At this point you could use <a href=https://en.wikipedia.org/wiki/HSL_and_HSV>HSV</a> as it breaks color into Hue, Saturation and Brightness. But as I was working primarily with CIELab I opted for <a href=https://en.wikipedia.org/wiki/CIELUV_color_space#Cylindrical_representation>CIELch</a> which can easily be converted to and has similar Hue, Chroma and Luminosity axis to work with.</p><p>So now let&rsquo;s convert CIELab to CIELch and sort by Hue then Luminosity then Chroma</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-clojure data-lang=clojure><span style=display:flex><span>	(<span style=color:#66d9ef>defn </span>cielab-to-cielch [color] 
</span></span><span style=display:flex><span>		(<span style=color:#66d9ef>let </span>[l (<span style=color:#e6db74>:cieL</span> color)
</span></span><span style=display:flex><span>		     a (<span style=color:#e6db74>:cieA</span> color)
</span></span><span style=display:flex><span>		     b (<span style=color:#e6db74>:cieB</span> color)
</span></span><span style=display:flex><span>		     h (<span style=color:#a6e22e>Math/atan2</span> a b)
</span></span><span style=display:flex><span>		     c (<span style=color:#a6e22e>Math/sqrt</span> (+ (<span style=color:#a6e22e>Math/pow</span> a <span style=color:#ae81ff>2</span>) (<span style=color:#a6e22e>Math/pow</span> b <span style=color:#ae81ff>2</span>)))]
</span></span><span style=display:flex><span>		 (<span style=color:#66d9ef>if </span>(&gt; h <span style=color:#ae81ff>0</span>) 
</span></span><span style=display:flex><span>		   (merge color {<span style=color:#e6db74>:cieC</span> c <span style=color:#e6db74>:cieH</span> (* (/ h (<span style=color:#a6e22e>Math/PI</span>)) <span style=color:#ae81ff>180</span>)}) 
</span></span><span style=display:flex><span>		   (merge color {<span style=color:#e6db74>:cieC</span> c <span style=color:#e6db74>:cieH</span> (- <span style=color:#ae81ff>360</span> (* (/ (<span style=color:#a6e22e>Math/abs</span> h) (<span style=color:#a6e22e>Math/PI</span>)) <span style=color:#ae81ff>180</span>))}))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>;; Sorting by CIELch</span>
</span></span><span style=display:flex><span>	(<span style=color:#66d9ef>defn </span>sort-by-cielch [colors]
</span></span><span style=display:flex><span>		(sort-by (<span style=color:#a6e22e>juxt</span> <span style=color:#e6db74>:cieH</span> <span style=color:#e6db74>:cieL</span> <span style=color:#e6db74>:cieC</span>) (map <span style=color:#f92672>#</span>(<span style=color:#a6e22e>cielab-to-cielch</span> %) colors)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	(<span style=color:#a6e22e>fact</span> <span style=color:#e6db74>&#34;can convert from cielab to cielch&#34;</span>
</span></span><span style=display:flex><span>	 (<span style=color:#a6e22e>cielab-to-cielch</span> {<span style=color:#e6db74>:cieL</span> <span style=color:#ae81ff>88.0459</span> <span style=color:#e6db74>:cieA</span> <span style=color:#ae81ff>6.5440</span> <span style=color:#e6db74>:cieB</span> <span style=color:#ae81ff>-3.1817</span>}) 
</span></span><span style=display:flex><span>		   =&gt; (<span style=color:#a6e22e>contains</span> {<span style=color:#e6db74>:cieC</span> <span style=color:#ae81ff>7.2764792922126835</span> <span style=color:#e6db74>:cieH</span> <span style=color:#ae81ff>115.92907185324125</span>})) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	(<span style=color:#a6e22e>fact</span> <span style=color:#e6db74>&#34;can sort colors by cielch&#34;</span>
</span></span><span style=display:flex><span>		(first (<span style=color:#a6e22e>sort-by-cielch</span> red-colors)) 
</span></span><span style=display:flex><span>				=&gt; (<span style=color:#a6e22e>contains</span> {<span style=color:#e6db74>:cieC</span> <span style=color:#ae81ff>5.744894008793722</span> <span style=color:#e6db74>:cieH</span> <span style=color:#ae81ff>30.45499414831985</span>})
</span></span><span style=display:flex><span>		(last (<span style=color:#a6e22e>sort-by-cielch</span> red-colors)) 
</span></span><span style=display:flex><span>				=&gt; (<span style=color:#a6e22e>contains</span> {<span style=color:#e6db74>:cieC</span> <span style=color:#ae81ff>8.175087286105267</span> <span style=color:#e6db74>:cieH</span> <span style=color:#ae81ff>121.03086930350263</span>})) </span></span></code></pre></div><p>Which looks like this&mldr;</p><div style=margin-bottom:32px;overflow:auto><div style=float:left;width:40px;height:40px;background-color:#f1e5dc>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#efd9d0>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#eeded7>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#d79380>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#af5142>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f3d1c9>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#712a29>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#842328>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#e2c3bf>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f1a7a2>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#b77774>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#d29a98>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#aa3f55>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#db9099>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#ac568e>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#e7d9e3>&nbsp;</div></div><div style=clear:left></div><p>That&rsquo;s a bit better&mldr;</p><ol><li>The colors are now starting at the Orange-Red colors, moving into the Strong-Red colors and then into the Red-Blue (Purple) colors.</li><li>Within each group of hue they are now graduating from dark to light.</li></ol><p>We&rsquo;re left with a small problem though. The value for Hue has a high precision, I found that limiting the hue to an integer ensured that values like (for example) 63.445 and 63.346 were both treated as 63 and then are ordered together by luminosity and chroma.</p><h3 id=sorting-only-by-luminosity-and-chroma>Sorting only by Luminosity and Chroma</h3><p>If you are working in a limited hue range already like the set of colors we&rsquo;re working with. Then you could order them by only the Luminosity and Chroma.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-clojure data-lang=clojure><span style=display:flex><span>	(<span style=color:#66d9ef>defn </span>sort-by-cielch [colors]
</span></span><span style=display:flex><span>		(sort-by (<span style=color:#a6e22e>juxt</span> <span style=color:#e6db74>:cieL</span> <span style=color:#e6db74>:cieC</span>) (map <span style=color:#f92672>#</span>(<span style=color:#a6e22e>cielab-to-cielch</span> %) colors)))</span></span></code></pre></div><p>Which looks like this&mldr;</p><div style=margin-bottom:32px;overflow:auto><div style=float:left;width:40px;height:40px;background-color:#712a29>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#842328>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#aa3f55>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#af5142>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#ac568e>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#b77774>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#d79380>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#db9099>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#d29a98>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f1a7a2>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#e2c3bf>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f3d1c9>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#e7d9e3>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#eeded7>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#efd9d0>&nbsp;</div><div style=float:left;width:40px;height:40px;background-color:#f1e5dc>&nbsp;</div></div><div style=clear:left></div><h3 id=there-appears-to-be-no-correct-answer>There appears to be no correct answer</h3><p>For me, I was trying to place colors into a grid that a user could select from. Ordering by Hue/Luminosity/Chroma made more sense as it allowed the person to find a lighter or darker version of the color which is a lot harder to achieve if you just order by Luminosity/Chroma.</p><p>Hopefully this serves as a quick intro for anyone looking to do something similar. If anyone else has done this with a greater level of success id be thrilled to hear from you.</p></div></main></body></html>